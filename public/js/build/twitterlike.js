var Main=React.createClass({displayName:"Main",getInitialState:function(){return{data:[]}},componentDidMount:function(){this.getPosts(),setInterval(this.getPosts,this.props.refreshInt)},getPosts:function(){$.ajax({url:this.props.url,dataType:"json",success:this.onPostsCallSuccess,error:this.onPostsCallError})},onPostsCallSuccess:function(e){this.setState({data:e})},onPostsCallError:function(e,t,a){console.error(this.props.url,t,a.toString())},onNewPost:function(e){var t=this.state.data,a=t.concat([e]);this.setState({data:a}),$.ajax({url:this.props.url,dataType:"json",type:"POST",data:e,success:this.onPostsCallSuccess,error:this.onPostsCallError})},onLogout:function(){Parse.User.logOut(),renderAuthView()},render:function(){return React.createElement("div",{className:"main"},React.createElement("h2",{className:"text-muted"},"Hi ",Parse.User.current().getUsername(),"! ",React.createElement("button",{onClick:this.onLogout,className:"btn btn-default btn-xs"},"Logout")),React.createElement(NewStatusForm,{onNewPost:this.onNewPost}),React.createElement(StatusList,{data:this.state.data}))}}),StatusList=React.createClass({displayName:"StatusList",render:function(){var e=_.sortBy(this.props.data,"created_time").reverse();return e=e.map(function(e){return React.createElement("li",{className:"list-group-item"},React.createElement(StatusPost,{message:e.message,created:e.created_time,username:e.username},e.message))}),React.createElement("ul",{className:"list-group"},e)}}),NewStatusForm=React.createClass({displayName:"NewStatusForm",handleSubmit:function(e){e.preventDefault();var t=this.refs.message,a=React.findDOMNode(t).value.trim(),r=Parse.User.current().getUsername();r&&a&&(this.props.onNewPost({username:r,message:a,created_time:+new Date}),React.findDOMNode(t).value="")},render:function(){return React.createElement("form",{className:"form-horizontal center-block",onSubmit:this.handleSubmit},React.createElement("div",{className:"input-group"},React.createElement("input",{className:"form-control input-lg",placeholder:"What's happening?",ref:"message",type:"text"}),React.createElement("div",{className:"input-group-btn"},React.createElement("input",{className:"btn btn-lg btn-primary",type:"submit",value:"Post"}))))}}),StatusPost=React.createClass({displayName:"StatusPost",render:function(){return React.createElement("div",{className:"status-post"},React.createElement("h4",null,this.props.username),React.createElement("p",null,this.props.message),React.createElement("small",{className:"text-muted"},moment(parseInt(this.props.created)).fromNow()))}}),AuthenticationForm=React.createClass({displayName:"AuthenticationForm",createAccount:function(e){var t=new Parse.User;t.set("username",e.username),t.set("password",e.password),t.set("email",e.email),t.signUp(null,{success:function(){renderFeedView()},error:function(e,t){alert("Error: "+t.code+" "+t.message)}})},onCreateAccount:function(e){e.preventDefault();var t=React.findDOMNode(this.refs.username).value.trim(),a=React.findDOMNode(this.refs.email).value.trim(),r=React.findDOMNode(this.refs.password).value.trim();this.createAccount({username:t,email:a,password:r})},login:function(e){Parse.User.logIn(e.username,e.password,{success:function(){renderFeedView()},error:function(e,t){alert("Error: "+t.code+" "+t.message)}})},onLogin:function(e){e.preventDefault();var t=React.findDOMNode(this.refs.log_username).value.trim(),a=React.findDOMNode(this.refs.log_password).value.trim();this.login({username:t,password:a})},render:function(){return React.createElement("div",{className:"authentication-form"},React.createElement("h3",null,"Sign-in !"),React.createElement("form",{className:"form-inline",onSubmit:this.onCreateAccount},React.createElement("div",{className:"form-group"},React.createElement("input",{className:"input-lg form-control",type:"text",ref:"username",placeholder:"Username"})),React.createElement("div",{className:"form-group"},React.createElement("input",{className:"input-lg form-control",type:"text",ref:"email",placeholder:"Email"})),React.createElement("div",{className:"form-group"},React.createElement("input",{className:"input-lg form-control",type:"password",ref:"password",placeholder:"Password"})),React.createElement("div",{className:"form-group"},React.createElement("input",{className:"btn btn-primary",type:"submit",value:"Create my account!"}))),React.createElement("h3",null,"Login"),React.createElement("form",{className:"form-inline",onSubmit:this.onLogin},React.createElement("div",{className:"form-group"},React.createElement("input",{className:"input-lg form-control",type:"text",ref:"log_username",placeholder:"Username"})),React.createElement("div",{className:"form-group"},React.createElement("input",{className:"input-lg form-control",type:"password",ref:"log_password",placeholder:"Password"})),React.createElement("div",{className:"form-group"},React.createElement("input",{className:"btn btn-primary",type:"submit",value:"Login"}))))}});Parse.initialize("t4UoMELz7WY339ZMMRMdhuRXi8u0U5gBhKg7m977","xI3WhlPFvfy3Nkfk5MR1es1ODUNFEf3UfUTHN9j6");var renderAuthView=function(){React.render(React.createElement(AuthenticationForm,null),document.getElementById("main"))},renderFeedView=function(){React.render(React.createElement(Main,{url:"posts.json",refreshInt:3e3}),document.getElementById("main"))};Parse.User.current()?renderFeedView():renderAuthView();